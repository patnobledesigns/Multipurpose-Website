{% extends 'movies/base.html' %}
{% load static %}


{% block content %}
<style>
  .post-body img{
    width: 100%;
  }
  label { 
    color: white!important;
}
span{
  color:white;
}
</style>
        
            <br><br>
            <div class="container">
                <div class="row">
                    <div class="col-md-6 col-lg-8 h-50">
                                {% if messages %}
         			     {% for message in messages %}
                  <div class="alert alert-success">
                    {{ message }}
                  </div>
           		   {% endfor %}
           	{% endif %}
                        <img src="{{ post.thumbnail }}" alt="..." style="height:12%;" class="img-fluid w-100 rounded" >
                        {% if request.user.is_superuser or request.user.is_staff %}
                  <div>
                    <a style="color: white;" class="btn btn-secondary btn-sm mt-1 mb-1" href="{{ post.get_update_url }}">Update</a>
                    <a style="color: white;" class="btn btn-danger btn-sm mt-1 mb-1" href="{{ post.get_delete_url }}">Delete</a>
                  </div>
                  {% endif %}
                        <h3 class="mt-3">{{ post.title }}</h3>
                    <div class="post-body mb-2" data-aos="zoom-in" data-aos-delay="200" >
                       {{ post.content|safe }}
                    </div>
                  <div class="review">
                    <p class="author" data-aos="fade-left" data-aos-delay="200"><i class="fa fa-user-circle-o" aria-hidden="true" style="font-size: 15px;"></i> {{ post.author.user.username }}</p>
                    <p class="date ml-2" style="display: inline;" data-aos="fade-left" data-aos-delay="200"><i class="fa fa-clock-o" aria-hidden="true"></i> {{post.timestamp|timesince}} ago</p>
                    <p class="author ml-2" data-aos="fade-left" data-aos-delay="200"><i class="fa fa-eye" aria-hidden="true"></i> {{ post.view_count }}</p>
                    <p class="date ml-2" style="display: inline;" data-aos="fade-left" data-aos-delay="200"><i class="fa fa-comments-o" aria-hidden="true"></i> {{ post.comment_count }}</p>
                 </div>

                 <!-- navigation -->
                 <div class="posts-nav d-flex justify-content-between align-items-stretch flex-column flex-md-row">
                 {% if post.previous_post %}
                 
                 <a href="{{ post.previous_post.get_absolute_url  }}" class="prev-post text-left d-flex align-items-center mr-3">
                    <div class="icon prev"><i class="fa fa-angle-left" aria-hidden="true"></i></div>
                    <div class="text" ><strong class="text-secondary">Previous </strong>
                      <h6 style="display:block;">{{ post.previous_post.title }}</h6>
                    </div>
                    </a>
                    {% endif %}
                    {% if post.next_post %}
                    <a href="{{ post.next_post.get_absolute_url  }}" class="next-post text-right d-flex align-items-center justify-content-end">
                        <div class="text"><strong class="text-secondary">Next </strong>
                        <h6 style="display:block;">{{ post.next_post.title }}</h6>
                        </div>
                    <div class="icon next"><i class="fa fa-angle-right" aria-hidden="true">   </i></div>
                    </a>
                     {% endif %}
                    </div>
<br><br>
                    <div class="post-comments">
                        <header>
                          <h3 class="h6">Post Comments<span class="no-of-comments">({{ post.comments.count }})</span></h3>
                        </header>
                        {% for comment in post.get_comments %}
                        <div class="comment">
                          <div class="comment-header d-flex justify-content-between">
                            <div class="user d-flex align-items-center">
                              <div class="image">
                              <img src="{{ comment.user.author.profile_picture.url }}" alt="..." class="img-fluid rounded-circle">
                              </div>
                              <div class="title mt-4"><strong>{{ comment.user.username }}</strong><span class="date">{{ comment.timestamp|timesince }}</span></div>
                            </div>
                          </div>
                          <div class="comment-body mb-0">
                            <p>{{ comment.content }}</p>
                          </div>
                        </div>
                        {% if request.user == comment.user %}
                        <div class="text-right">
                            {% comment %} <a style="color: white;" class="btn btn-info btn-sm mt-1 mb-1 mr-1" href="{% url 'editreview' movies.slug review.id %}">Edit</a> {% endcomment %}
                            <a style="color: white;" class="btn btn-danger btn-sm mt-1 mb-1" href="{% url 'comment-delete' post.slug comment.id %}" onclick="return confirm('Are you sure you want to delete this?')">Delete</a>
                        </div>
                        {% endif %}
                        {% endfor %}

                      </div>

                      {% if request.user.is_authenticated %}
                      <div class="add-comment">
                        <header>
                          <h3 class="h6">Leave a reply</h3>
                        </header>
                        <form action=""  method="POST" class="commenting-form">
                          {% csrf_token %}
                          <div class="row">
                              <div class="form-group col-md-12">
                                  {{ form }}
                              </div>
                            <div class="form-group col-md-12">
                              <button type="submit" class="btn btn-outline-info btn-sm my-2 my-sm-0">Submit Comment</button>
                            </div>
                          </div>
                        </form>
                      </div>
                      {% else %}
                      <div class="form-group col-md-12">
                      <a href="{% url 'login' %}" type="submit" class="btn btn-outline-info btn-sm my-2 my-sm-0">Login to comment</a>
                      </div>
                      {% endif %}
                </div>
            
                  <div class="col-md-6 col-lg h-50">
                  {% include 'movies/aside.html' with most_recent=most_recent language_count=language_count %}
                   </div>
            </div>
      </div>
            

{% endblock %}